<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>所爱隔山海，山海难平——浅谈SDN | Ian21c's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">所爱隔山海，山海难平——浅谈SDN</h1><a id="logo" href="/.">Ian21c's Blog</a><p class="description">Peace &amp; Love ! Learning to think independently !</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">所爱隔山海，山海难平——浅谈SDN</h1><div class="post-meta">Jul 15, 2020<span> | </span><span class="category"><a href="/categories/technology/">technology</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#网络与云计算网络"><span class="toc-number">1.</span> <span class="toc-text">网络与云计算网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#网络虚拟化与虚拟网络"><span class="toc-number">2.</span> <span class="toc-text">网络虚拟化与虚拟网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SDN界的叛徒——openflow"><span class="toc-number">3.</span> <span class="toc-text">SDN界的叛徒——openflow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#山海难平"><span class="toc-number">4.</span> <span class="toc-text">山海难平</span></a></li></ol></div></div><div class="post-content"><p><strong><em>本文已投稿至 <a href="https://www.sdnlab.com/24294.html" target="_blank" rel="noopener">SDNLAB</a></em></strong></p>
<p><em>本文含大量主观看法，请以辩证的态度看待，另外本人认知有限，也在不断地学习和接受新知识，保留自省的权利。</em></p>
<p>正文开始前，我想简单提下我个人的经历，可能更容易有共感，也更易发现我观点中的偏执之处。一开始，我从事的是路由交换这样的传统网络工作，由于该方向在我个人职业规划上难看到较大发展，转型网络安全，后面随着SDN这个黑盒子的打开，兴趣所在，一头扎进了云计算网络相关的工作。</p>
<h3 id="网络与云计算网络"><a href="#网络与云计算网络" class="headerlink" title="网络与云计算网络"></a>网络与云计算网络</h3><p>什么是网络呢？有点难到我了，不知该从何处讲起。网络是埋在地下的光缆，是无处不在的电磁波，也是一个个的路由器、交换机，还是我们玩的微博、抖音。</p>
<p>得，直接搬维基百科吧：</p>
<blockquote>
<p><em>计算机网络</em>，通常也简称网络，是指容许节点分享资源的数字电信网络。在电脑网络，电脑设备会透过节点之间的连接互相交换数据。用于创建、路由及终止数据传输的电脑网络设备即为网络节点，比如个人电脑、电话、服务器、路由器等。当一个设备能够与另一设备交换信息时，便可视它们俩已连接成网络，而要维持网络的可靠性，便需要有一定的网络管理技能。</p>
</blockquote>
<p>本文讨论的网络意指狭义上的二、三层网络，其作用简要说明一下，就是标识、收敛、寻址和控制转发，这里就不展开赘述了。</p>
<p>那什么是云计算网络呢？这里就计算、存储、网络三个最大的方面一块说了吧。</p>
<p>计算：云计算的目标是可以自由调度计算资源，简单说就是可以随时按需提供CPU、GPU。那这些资源哪里来，这就是虚拟化了，使用虚拟化技术将这些分散的CPU等虚拟化为一个资源池，然后按需从里面分割出资源。</p>
<p>存储：同样是把一堆存储设备，比如SSD、HHD通过虚拟化技术向用户按需提供，云计算的作用是调度。这里能看出虚拟化的另一好处便是，更容易进行备份冗余。</p>
<p>网络：当我们提供出计算、存储资源后，这些资源要怎么通信呢？这些虚拟的设备我们不能直接拿网线、交换机、路由器去连啊，这时候就到网络功能虚拟化（NFV）和网络虚拟化上场了，使用虚拟逻辑网元将这些虚拟资源进行连接，再通过网络协议栈或其他手段（如 openflow）实现连通。这时，网络不仅是端到端的互联，还相当于一个云的总线系统。</p>
<h3 id="网络虚拟化与虚拟网络"><a href="#网络虚拟化与虚拟网络" class="headerlink" title="网络虚拟化与虚拟网络"></a>网络虚拟化与虚拟网络</h3><p>网络虚拟化我从来都认为其不是一项向前发展的技术，而是定义好的网络标准逐渐向实际网络业务妥协的一个过程。网络提供的是一种“自下而上”的服务：受网络功能的约束，而不是受业务需求的驱动。简单来说，就是当我们在使用网络的过程中，需要某些功能，这些功能原有的网络标准字段无法支持，我们就使用封装或者映射的方式，即再包裹一层或者字段置换来给予支持。</p>
<p>所以，网络虚拟化技术看起来五花八门，说到底其实就两个——封装和映射。封装，最典型的就是各种VPN了，比如IPSec、GRE等，还有目前云计算的基石之一VXLAN；映射，常见的就是NAT、代理一类。</p>
<p>无出其右，虚拟网络又是一次无奈的妥协。由于网络硬件厂商们因种种原因没能支持适配云计算网络的需求，软件研发者们干脆把数据包再包裹一层，在内层天马行空，这就是虚拟网络了，也常称为overlay网络，外层就老老实实扮演好管道的角色，即underlay网络，最明显的代价就是再次封装带来的转发性能损耗。</p>
<h3 id="SDN界的叛徒——openflow"><a href="#SDN界的叛徒——openflow" class="headerlink" title="SDN界的叛徒——openflow"></a>SDN界的叛徒——openflow</h3><p>接下来开始进入正题，谈SDN。其是一种思想，是为了实现网络控制平面和数据平面解耦的技术统称。</p>
<p>首先，来看看为什么要实现数控分离。在传统网络中，控制平面功能是分布式的运行在各个网络节点中的，如果想支持一个新的网络功能，就必须将所有网络设备进行升级，这极大地限制了网络创新，更不符合云计算网络中快速变更和迭代的需求。数控分离后，数据平面只需要关注通用的转发，尽可能的利用各种技术提高封包、拆包和转发的速率，控制平面则专注于抉择转发路径，同时扩展、迭代新功能以便支持业务需求。</p>
<p>既然说到SDN，就不得不提openflow。老实说，我个人是比较反感openflow的。我是对网络很感兴趣才入行的，网络最大的特性之一就是自愈性，当网元加入、离开网络，亦或是故障，网络会快速地自动重新收敛。原谅文笔糟糕的的我，不知道该怎么去形容它的美，让我如此痴迷，比如二层防环的生成树，OSPF最短路径的贪心算法，还有快速重路由等等，网元靠着这些算法、机制和协议，构建出一张张可靠的网络。提到的这些和我们沉浸刷LeetCode的快感并无二致，openflow虽然依葫芦画瓢也都能实现，但我在其中并没有感受到同样的快感。</p>
<p>然而，由于云计算的发展，前文有提到，二者一拍即合，有了现在的虚拟网络。SDN本是为了解放网络应运而生的，但在目前从业过程中，其让我的烦躁有过之而无不及，所以我将其称之为叛徒。</p>
<h3 id="山海难平"><a href="#山海难平" class="headerlink" title="山海难平"></a>山海难平</h3><p>看着DPDK、RDMA、SmartNIC、FPGA这些技术的发展，SDN的数据面可谓是一片光明，但控制面看着却让人糟心。</p>
<p>举个简单的例子，为了实现DVR，即点到点的二至三层转发，控制面我们既要同步mac信息，又要传递主机路由，为什么我们都已经重新封装了，还要笨拙的去模拟原先的网络协议栈，只有在不符合预期功能的时候才强行打破规则。</p>
<p>所以无关协议转发也是SDN的一个发展方向，另一个方向自然是去掉封装，向下打平，没错，说的就是Segment Routing，这种分布式智能加上集中控制的源路由方式又深深地吸引了我。</p>
<p>容器其实在这方面做过一些简单的尝试，比如flannel的vxlan模式较原生的vxlan模式，已经不是大二层的概念了，其根本是由路由控制的，减少了内层二层信息在三层上的泛滥，再比如calico考虑和实体网元交互信息从而打平网络，但这种全量的分发和隔离控制在大规模网络下并不可取，这些都是小打小闹了。反观云原生，其所谓的四层以上的SDN，ServiceMesh，好不热闹，二、三层却好像还是一地鸡毛。</p>
<p>另外在从业过程中，也发现一些比较奇怪的现象，比如大家好像总喜欢推崇虚拟网络，乐于去攻坚其中的复杂问题，undelay网络却不屑一顾。其实在我看来，虚拟网络反而是很简单的那一个，而且得益于现在大规模数据中心底层clos架构的推进，就算是公有云的规模，虚拟网络的控制层面在网络结构的复杂性上面还是远远不及传统网络的，正如前文所述，其意义更像是一个云系统的总线，也正由于此，很多人总向我说，控制面不就是简单的向下下发配置么，也是，overlay的组网目前都还较为简单，流量工程就更远了。但随着规模的增长、5G和边缘计算的发展、云网融合等，我们对于云网络的需求远远不是止步于此。目前的挑战就已经很严峻了，但更大的挑战还在后面，我们正因为此，勇攀高峰，行业也正因为此，蒸蒸日上。希望我们在解决云网络控制面的问题时，不要总是聚焦于传统互联网那一套解决方案，可以多多借鉴其本身的网络思想，说不定柳暗花明又一村呢。</p>
<p>愿海有舟可渡，山有路可行！</p>
</div><div class="tags"><a href="/tags/network/">network</a><a href="/tags/cloud/">cloud</a><a href="/tags/sdn/">sdn</a></div><div class="post-nav"><a class="pre" href="/2020/10/28/成都购房指北/">成都购房指北</a><a class="next" href="/2020/04/02/Mac使用zmodem传输文件/">Mac使用zmodem传输文件</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'cf6cbb233152befba374',
  clientSecret: 'd1d9b814b36163460ad6241843c4d1be861fe7db',
  repo: 'BlogComments',
  owner: 'sirius21c',
  admin: ['sirius21c'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://21c.me"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/emotion/">emotion</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/technology/">technology</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/network/" style="font-size: 21.67px;">network</a> <a href="/tags/Happy-Birthday/" style="font-size: 15px;">Happy Birthday</a> <a href="/tags/随笔/" style="font-size: 16.67px;">随笔</a> <a href="/tags/neutron/" style="font-size: 23.33px;">neutron</a> <a href="/tags/openstack/" style="font-size: 25px;">openstack</a> <a href="/tags/travel/" style="font-size: 15px;">travel</a> <a href="/tags/calico/" style="font-size: 15px;">calico</a> <a href="/tags/k8s/" style="font-size: 16.67px;">k8s</a> <a href="/tags/octavia/" style="font-size: 15px;">octavia</a> <a href="/tags/mac/" style="font-size: 15px;">mac</a> <a href="/tags/tool/" style="font-size: 15px;">tool</a> <a href="/tags/openflow/" style="font-size: 16.67px;">openflow</a> <a href="/tags/note/" style="font-size: 18.33px;">note</a> <a href="/tags/cloud/" style="font-size: 20px;">cloud</a> <a href="/tags/sdn/" style="font-size: 18.33px;">sdn</a> <a href="/tags/sfc/" style="font-size: 15px;">sfc</a> <a href="/tags/firewall对接/" style="font-size: 18.33px;">firewall对接</a> <a href="/tags/security/" style="font-size: 16.67px;">security</a> <a href="/tags/tripleo/" style="font-size: 15px;">tripleo</a> <a href="/tags/ovs/" style="font-size: 18.33px;">ovs</a> <a href="/tags/linux-bridge/" style="font-size: 15px;">linux bridge</a> <a href="/tags/devstack/" style="font-size: 15px;">devstack</a> <a href="/tags/poetry/" style="font-size: 15px;">poetry</a> <a href="/tags/边缘计算/" style="font-size: 15px;">边缘计算</a> <a href="/tags/5G/" style="font-size: 15px;">5G</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/kvm/" style="font-size: 15px;">kvm</a> <a href="/tags/SR-IOV/" style="font-size: 15px;">SR-IOV</a> <a href="/tags/VPNaaS/" style="font-size: 15px;">VPNaaS</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/11/29/ARP缓存更新机制/">ARP缓存更新机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/07/13/NCN-Draft/">NCN-Draft</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/17/主机路由详解/">主机路由详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/05/不识庐山真面目——我在虚拟网的打怪升级之路/">不识庐山真面目——我在虚拟网的打怪升级之路</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/28/成都购房指北/">成都购房指北</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/15/所爱隔山海，山海难平——浅谈SDN/">所爱隔山海，山海难平——浅谈SDN</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/02/Mac使用zmodem传输文件/">Mac使用zmodem传输文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/06/PrivateNote-BCloudNet/">PrivateNote_BCloudNet</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/11/CentaraGrand/">CentaraGrand</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/19/虚拟网络优化与测试/">虚拟网络优化与测试</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">Ian21c's Blog.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" color="0,0,0" opacity="0.6" zindex="-1" count="55" src="//lib.baomitu.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>